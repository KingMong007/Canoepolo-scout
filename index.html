<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="manifest" href="manifest.json"/>
  <meta name="theme-color" content="#1a2a6c"/>

  <!-- iOS PWA hints -->
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="default"/>
  <link rel="apple-touch-icon" href="icons/icon-192.png"/>

  <title>Canoepolo Scouting App</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link rel="stylesheet" href="style.css"/>

  <!-- App-script met cache-bust -->
  <script defer src="app.js?v=20250902a"></script>
</head>

<body>
  <div class="container">
    <header class="site-header">
      <div class="header-left">
        <img src="rectusoft.png" alt="Rectusoft" class="brand-logo"/>
      </div>

      <!-- CTA: New game -->
      <button class="header-cta" onclick="resetAndShowSetup()">
        <i class="fas fa-rotate-left"></i> New game
      </button>

      <div class="brand-copy">
        <div class="logo"><span>Canoepolo Scouting</span></div>
        <p>Track results of players</p>
      </div>
    </header>

    <!-- Startscherm -->
    <div id="setupScreen" class="setup-screen">
      <div class="setup-title"><i class="fas fa-cog"></i> Game Settings</div>
      <div class="setup-form">
        <div class="input-group">
          <label for="setupPlayerName">Player Name</label>
          <input type="text" id="setupPlayerName" placeholder="Speler naam"/>
        </div>
        <div class="input-group">
          <label for="setupPlayerNumber">Player Jersey Number</label>
          <input type="number" id="setupPlayerNumber" placeholder="Rugnummer"/>
        </div>
        <div class="input-group">
          <label for="setupOwnTeam">Your Team</label>
          <input type="text" id="setupOwnTeam" placeholder="Jouw team naam"/>
        </div>
        <div class="input-group">
          <label for="setupOpponent">Opponent</label>
          <input type="text" id="setupOpponent" placeholder="Tegenstander team"/>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="setupIsGoalkeeper"/>
          <label for="setupIsGoalkeeper">Is this player a goalkeeper?</label>
        </div>
      </div>
      <button id="startScoutingBtn" type="button" class="btn btn-success btn-large" onclick="saveSetup()">
        Start Scouting
      </button>
    </div>

    <!-- Hoofdcontent -->
    <div id="mainContent" style="display:none;">
      <div class="player-header">
        <div class="player-info-compact" id="playerInfoCompact"></div>
      </div>

      <!-- Tabs -->
      <div class="tabs">
        <div class="tab active" onclick="switchTab('scouting')" aria-label="Scouting">
          <i class="fas fa-binoculars"></i> Scouting
        </div>
        <div class="tab" onclick="switchTab('stats')" aria-label="Stats">
          <i class="fas fa-chart-bar"></i> Stats
        </div>
        <div class="tab" onclick="switchTab('scorepanel')" aria-label="Scorepanel">
          <i class="fas fa-stopwatch"></i> Scorepanel
        </div>
        <div class="tab" onclick="switchTab('settings')" aria-label="Settings">
          <i class="fas fa-cog"></i> Settings
        </div>
      </div>

      <!-- Scouting -->
      <div id="scouting" class="tab-content active">
        <div class="playtime-section">
          <div class="playtime-label">
            <i class="fas fa-clock"></i>Effective playing time
          </div>
          <div class="playtime-display" id="playtimeDisplay">00:00</div>
        </div>

        <div class="playtime-controls">
          <button class="time-control-btn btn-grijs" id="addMinuteBtn" onclick="addMinute()">+1 min</button>
          <button class="playtime-btn not-playing" id="playtimeBtn" onclick="togglePlaytime()">Player in the substitution zone</button>
          <button class="time-control-btn btn-grijs" id="subtractMinuteBtn" onclick="subtractMinute()">-1 min</button>
        </div>

        <div class="stats-container">
          <!-- Passen -->
          <div class="stat-row">
            <div class="stat-box">
              <div class="stat-button">
                <button class="stat-btn btn-primary" id="goodPassBtn" onclick="increment('goodPasses')">
                  <i class="fas fa-check-circle"></i>Good passes
                  <div class="stat-value" id="goodPasses">0</div>
                </button>
                <button class="btn btn-grijs btn-small" id="goodPassMinusBtn" onclick="decrement('goodPasses')">-1</button>
              </div>
            </div>
            <div class="stat-box">
              <div class="stat-button">
                <button class="stat-btn btn-secondary" id="badPassBtn" onclick="increment('badPasses')">
                  <i class="fas fa-times-circle"></i>Bad passes
                  <div class="stat-value" id="badPasses">0</div>
                </button>
                <button class="btn btn-grijs btn-small" id="badPassMinusBtn" onclick="decrement('badPasses')">-1</button>
              </div>
            </div>
          </div>

          <!-- Assists & Interceptions -->
          <div class="stat-row">
            <div class="stat-box">
              <div class="stat-button">
                <button class="stat-btn btn-primary" id="assistBtn" onclick="increment('assists')">
                  <i class="fas fa-assistive-listening-systems"></i>Assists
                  <div class="stat-value" id="assists">0</div>
                </button>
                <button class="btn btn-grijs btn-small" id="assistMinusBtn" onclick="decrement('assists')">-1</button>
              </div>
            </div>
            <div class="stat-box">
              <div class="stat-button">
                <button class="stat-btn btn-primary" id="interceptionBtn" onclick="increment('interceptions')">
                  <i class="fas fa-exchange-alt"></i>Interceptions
                  <div class="stat-value" id="interceptions">0</div>
                </button>
                <button class="btn btn-grijs btn-small" id="interceptionMinusBtn" onclick="decrement('interceptions')">-1</button>
              </div>
            </div>
          </div>

          <!-- Goals -->
          <div class="stat-row">
            <div class="stat-box">
              <div class="stat-button">
                <button class="stat-btn btn-primary" id="goalBtn" onclick="increment('goals')">
                  <i class="fas fa-bullseye"></i>Goal
                  <div class="stat-value" id="goals">0</div>
                </button>
                <button class="btn btn-grijs btn-small" id="goalMinusBtn" onclick="decrement('goals')">-1</button>
              </div>
            </div>
            <div class="stat-box">
              <div class="stat-button">
                <button class="stat-btn btn-secondary" id="attemptBtn" onclick="increment('attempts')">
                  <i class="fas fa-bullseye"></i>Goal attempt
                  <div class="stat-value" id="attempts">0</div>
                </button>
                <button class="btn btn-grijs btn-small" id="attemptMinusBtn" onclick="decrement('attempts')">-1</button>
              </div>
            </div>
          </div>

          <!-- Goalkeeper -->
          <div id="goalkeeperSection">
            <div id="goalkeeperButtons">
              <div class="stat-row">
                <div class="stat-box">
                  <div class="stat-button">
                    <button class="stat-btn btn-primary" id="goalsDefendedBtn" onclick="increment('goalsDefended')">
                      <i class="fas fa-shield-alt"></i>Goals defended
                      <div class="stat-value" id="goalsDefended">0</div>
                    </button>
                    <button class="btn btn-grijs btn-small" id="goalsDefendedMinusBtn" onclick="decrement('goalsDefended')">-1</button>
                  </div>
                </div>
                <div class="stat-box">
                  <div class="stat-button">
                    <button class="stat-btn btn-secondary" id="goalsAgainstBtn" onclick="increment('goalsAgainst')">
                      <i class="fas fa-times-circle"></i>Goals against
                      <div class="stat-value" id="goalsAgainst">0</div>
                    </button>
                    <button class="btn btn-grijs btn-small" id="goalsAgainstMinusBtn" onclick="decrement('goalsAgainst')">-1</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>

        <div class="end-button">
          <button class="btn btn-success btn-large" id="endGameBtn" onclick="endGame()">
            <i class="fas fa-flag-checkered"></i> End of match
          </button>
        </div>
      </div>

      <!-- Settings (met subtabs) -->
      <div id="settings" class="tab-content">
        <h2><i class="fas fa-cog"></i> Settings</h2>

        <div class="subtabs">
          <button class="subtab active" onclick="switchSettingsTab('general')">
            <i class="fas fa-sliders"></i> General
          </button>
          <button class="subtab" onclick="switchSettingsTab('modify')">
            <i class="fas fa-user-pen"></i> Modify player
          </button>
        </div>

        <!-- General -->
        <div id="settings-general" class="subtab-content active">
          <div class="settings-grid">
            <div class="settings-group">
              <div class="settings-title">Game Settings</div>

              <div class="input-group">
                <label for="halfDuration">Duration of a half (minutes)</label>
                <input type="number" id="halfDuration" value="10" min="1" max="60"/>
              </div>

              <div class="input-group">
                <label for="restDuration">Rest between halves (minutes)</label>
                <input type="number" id="restDuration" value="3" min="0" max="30"/>
              </div>

              <div class="input-group">
                <label for="shotClock">Shot clock (seconds)</label>
                <input type="number" id="shotClock" value="60" min="1" max="999"/>
              </div>

              <div class="input-group">
                <label for="shotWarnSec">Shot warning at (seconds remaining)</label>
                <input type="number" id="shotWarnSec" value="20" min="1" max="998"/>
              </div>

              <div class="checkbox-group">
                <input type="checkbox" id="shotVibrate" checked/>
                <label for="shotVibrate">Vibrate (if supported)</label>
              </div>

              <div class="input-group">
                <label for="shotVolume">Signal volume</label>
                <input type="range" id="shotVolume" min="0" max="100" value="60"/>
              </div>

              <div class="input-group">
                <label for="numberOfHalves">Number of halves (1-6)</label>
                <select id="numberOfHalves">
                  <option>1</option>
                  <option selected>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                  <option>6</option>
                </select>
              </div>
            </div>
          </div>

          <button class="btn save-settings" onclick="saveSettings()">
            <i class="fas fa-save"></i>Save settings
          </button>

          <div class="action-buttons" style="margin-top:12px;">
            <button class="btn btn-danger btn-large" onclick="resetAndShowSetup()">
              <i class="fas fa-rotate-left"></i> New match / show start screen
            </button>
          </div>
        </div>

        <!-- Modify player -->
        <div id="settings-modify" class="subtab-content">
          <div class="settings-grid">
            <div class="settings-group">
              <div class="settings-title">Player Settings</div>

              <div class="input-group">
                <label for="playerName">Player Name</label>
                <input type="text" id="playerName" placeholder="Speler naam"/>
              </div>
              <div class="input-group">
                <label for="playerNumber">Player jersey number</label>
                <input type="number" id="playerNumber" placeholder="Rugnummer"/>
              </div>
              <div class="checkbox-group">
                <input type="checkbox" id="isGoalkeeper" onchange="toggleGoalkeeperButtons()"/>
                <label for="isGoalkeeper">Is this player a goalkeeper?</label>
              </div>
            </div>

            <div class="settings-group">
              <div class="settings-title">Team Settings</div>
              <div class="input-group">
                <label for="ownTeam">Your team name</label>
                <input type="text" id="ownTeam" placeholder="Jouw team naam"/>
              </div>
            </div>
          </div>

          <button class="btn save-settings" onclick="savePlayerFromModify()">
            <i class="fas fa-save"></i>Save player
          </button>
        </div>
      </div>

      <!-- Scorepanel -->
     <div id="scorepanel" class="tab-content">
  <!-- SCOREBORD -->
  <div id="tab-scoreboard" class="sb-wrapper">

    <header class="sb-header">
      <h2>Scorebord</h2>
      <div class="sb-actions">
        <button id="sb-settings-open" class="sb-btn tertiary" title="Instellingen">⚙</button>
        <button id="sb-fullscreen" class="sb-btn tertiary" title="Volledig scherm">⛶</button>
        <button id="sb-new-game" class="sb-btn danger" title="Nieuwe wedstrijd">Nieuwe wedstrijd</button>
      </div>
    </header>

    <div class="sb-grid">
      <!-- TEAM LINKS -->
      <div class="sb-team" data-team="home">
        <input id="sb-home-name" class="sb-team-name" value="Thuis" maxlength="18"/>
        <div class="sb-score" id="sb-home-score">0</div>
        <div class="sb-score-ctrls">
          <button class="sb-btn" data-score="home" data-delta="1">+1</button>
          <button class="sb-btn ghost" data-score="home" data-delta="-1">−1</button>
        </div>
      </div>

      <!-- MIDDEN: TIMERS & CONTROLS -->
      <div class="sb-center">
        <!-- WEDSTRIJDKLOK -->
        <div class="sb-box">
          <div class="sb-row between">
            <div class="sb-col">
              <div class="sb-label">Fase</div>
              <div id="sb-phase" class="sb-phase">Vooraf</div>
            </div>
            <div class="sb-col">
              <div class="sb-label">Periode</div>
              <div id="sb-period" class="sb-period-val">1</div>
            </div>
          </div>
          <div id="sb-game-time" class="sb-game-time">10:00</div>
          <div class="sb-ctrls">
            <button class="sb-btn primary" id="sb-game-toggle">Start / Pauze (Spatie)</button>
            <button class="sb-btn" id="sb-game-reset">Reset periode</button>
            <button class="sb-btn" id="sb-next-phase">Volgende fase</button>
          </div>
        </div>

        <!-- SHOTKLOK -->
        <div class="sb-shot sb-box">
          <div class="sb-row between">
            <div class="sb-label">Shotklok</div>
            <div class="sb-help-mini">Waarschuwing bij <span id="sb-warn-at">20</span>s</div>
          </div>
          <div id="sb-shot-time" class="sb-shot-time">60</div>
         <div class="sb-shot-ctrls">
          <button class="sb-btn primary" id="sb-shot-start" disabled>Start / Pauze (S)</button>
          <button class="sb-btn sb-btn--xl" id="sb-shot-reset">RESET (R)</button>
          <label class="sb-custom">
          <!--  <input id="sb-shot-custom" type="number" min="1" max="999" value="60" />
            <button class="sb-btn" id="sb-shot-set">Set</button>
          </label>-->
        </div>  

          <div class="sb-note">Shotklok pauzeert automatisch wanneer de wedstrijdtijd pauzeert.</div>
        </div>
      </div>

      <!-- TEAM RECHTS -->
      <div class="sb-team" data-team="away">
        <input id="sb-away-name" class="sb-team-name" value="Uit" maxlength="18"/>
        <div class="sb-score" id="sb-away-score">0</div>
        <div class="sb-score-ctrls">
          <button class="sb-btn" data-score="away" data-delta="1">+1</button>
          <button class="sb-btn ghost" data-score="away" data-delta="-1">−1</button>
        </div>
      </div>
    </div>

    <footer class="sb-footer">
      <div class="sb-help">
        <strong>Sneltoetsen:</strong> Spatie = wedstrijd Start/Pauze • S = shotklok Start/Pauze • R = reset shotklok • N = volgende fase • H/A = +1 (Shift = −1)
      </div>
    </footer>
  </div>

  <!-- INSTELLINGEN MODAL (scorebord) -->
  <dialog id="sb-settings" class="sb-modal">
    <form method="dialog" class="sb-modal-inner">
      <header class="sb-modal-header">
        <h3>Instellingen</h3>
        <button class="sb-btn ghost" id="sb-settings-close" value="cancel" aria-label="Sluit">✕</button>
      </header>

      <div class="sb-form-grid">
        <label>
          <span>Speeltijd per helft (min)</span>
          <input type="number" id="cfg-half-min" min="1" max="60" value="10">
        </label>
        <label>
          <span>Rusttijd tussen helften (min)</span>
          <input type="number" id="cfg-halftime-min" min="0" max="30" value="3">
        </label>
        <label>
          <span>Shotklok (s)</span>
          <input type="number" id="cfg-shot-sec" min="1" max="999" value="60">
        </label>
        <label>
          <span>Shot waarschuwing bij (s resterend)</span>
          <input type="number" id="cfg-warn-sec" min="1" max="998" value="20">
        </label>
        <label class="sb-row between">
          <span>Trillen (indien ondersteund)</span>
          <input type="checkbox" id="cfg-vibrate" checked>
        </label>
        <label>
          <span>Volume signaal</span>
          <input type="range" id="cfg-volume" min="0" max="100" value="60">
        </label>
      </div>

      <footer class="sb-modal-footer">
        <button class="sb-btn" id="cfg-save">Bewaar</button>
        <button class="sb-btn ghost" value="cancel">Annuleer</button>
      </footer>
    </form>
  </dialog>
</div>


      <!-- Stats -->
      <div id="stats" class="tab-content">
        <h2><i class="fas fa-chart-bar"></i>Statistics overview</h2>

        <div class="settings-group">
          <div class="settings-title">Current player performance</div>
          <div class="stats-grid-2">
            <p>Effective playing time: <span id="totalPlaytime">00:00</span></p>
            <p>Player involvement: <span id="involvement">0.0</span><span> /min</span></p>
            <p>Goaleffectiveness: <span id="shotAccuracy">0%</span></p>
            <p>Passing accuracy: <span id="passAccuracy">0%</span></p>
            <p id="savePctText" style="display:none;">Save (goalkeeper): <span id="keeperSavePct">0%</span></p>
            <p>Total passes: <span id="totalPasses">0</span></p>
            <p>Total shots: <span id="totalShots">0</span></p>
            <p>Assists: <span id="assist">0</span></p>
            <p>Interceptions: <span id="totalInterceptions">0</span></p>
            <p id="goalsAgainstText" style="display:none;">Goals against: <span id="goalsAgainstStat">0</span></p>
            <p id="goalsDefendedText" style="display:none;">Goals defended: <span id="goalsDefendedStat">0</span></p>
          </div>
        </div>

        <div class="scouting-list">
          <div class="settings-title">Saved scouting reports</div>
          <div id="savedScoutings">
            <p>No scouting reports saved yet</p>
          </div>
        </div>

        <div class="settings-group premium-feature">
          <div class="premium-label">PRO VERSION</div>
          <div class="settings-title">Advanced Statistics</div>
          <ul>
            <li>Player involvement in the game</li>
            <li>Trend analysis across multiple matches</li>
            <li>Comparison with teammates</li>
            <li>Export to Excel and PDF</li>
          </ul>
        </div>
      </div>

    </div>
  </div>
</body>
</html>
