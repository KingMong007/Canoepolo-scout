<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a2a6c">

    <!-- iOS PWA hints -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <title>Canoepolo Scouting App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
      // Service worker (HTTPS vereist – GitHub Pages is HTTPS)
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('sw.js').catch(console.error);
        });
      }
    </script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        header {
            background: #1a2a6c;
            color: white;
            padding: 15px;
            text-align: center;
            position: relative;
        }
        
        .logo {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-icon {
            margin-right: 8px;
            font-size: 26px;
        }

        .is-hidden { 
            display: none;
        }

        .app-version {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #fdbb2d;
            color: #333;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .player-header {
            background: #2c3e50;
            color: white;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-info-compact {
            font-size: 16px;
        }
        
        .edit-player-btn {
            background: #fdbb2d;
            color: #1a2a6c;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .tabs {
            display: flex;
            background: #2c3e50;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            transition: background 0.3s;
            font-size: 14px;
        }
        
        .tab.active {
            background: #fdbb2d;
            color: #1a2a6c;
        }
        
        .tab-content {
            display: none;
            padding: 15px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .setup-screen {
            padding: 20px;
            text-align: center;
        }
        
        .setup-title {
            font-size: 24px;
            color: #1a2a6c;
            margin-bottom: 20px;
        }
        
        .setup-form {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-group {
            margin-bottom: 12px;
            text-align: left;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #1a2a6c;
            font-size: 12px;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .checkbox-group input {
            margin-right: 10px;
            width: 20px;
            height: 20px;
        }
        
        .playtime-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid #1a2a6c;
        }
        
        .playtime-label {
            font-weight: bold;
            color: #1a2a6c;
            font-size: 16px;
            display: flex;
            align-items: center;
        }
        
        .playtime-label i {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .playtime-display {
            font-size: 24px;
            font-weight: bold;
            color: white;
            background: #1a2a6c;
            padding: 8px 15px;
            border-radius: 20px;
            min-width: 85px;
            text-align: center;
        }
        
        .playtime-controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            align-items: center;
        }
        
        .playtime-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
            flex: 3;
        }
        
        .playtime-btn.playing {
            background: #4CAF50;
            color: white;
        }
        
        .playtime-btn.not-playing {
            background: #d9534f;
            color: white;
        }
        
        .time-control-btn {
            padding: 15px 10px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
            flex: 1;
            min-width: 80px;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        .stat-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .stat-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            border: 2px solid #e9ecef;
        }
        
        .stat-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
        
        .stat-btn {
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
            width: 100%;
            margin-bottom: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .stat-btn:active {
            transform: scale(0.97);
        }
        
        .stat-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #2c3e50;
            margin: 5px 0;
        }
        
        .btn-small {
            padding: 8px;
            font-size: 12px;
            width: 50px;
            border: none;
            font-weight: bold;
        }
        
        .btn-primary {
            background: #4CAF50;
            color: white;
        }
        
        .btn-secondary {
            background: #f0ad4e;
            color: white;
        }
        
        .btn-grijs {
            background: #adb5bd;
            color: white;
            border-radius: 10px;
        }
        .btn-danger {
            background: #d9534f;
            color: white;
        }
        
        .btn-success {
            background: #1a2a6c;
            color: white;
        }
        
        .goalkeeper-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed #ddd;
        }
        
        .goalkeeper-title {
            font-weight: bold;
            color: #1a2a6c;
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .goalkeeper-buttons {
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 15px;
            display: none;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .settings-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .settings-title {
            font-weight: bold;
            color: #1a2a6c;
            margin-bottom: 12px;
            font-size: 16px;
            padding-bottom: 5px;
            border-bottom: 2px solid #fdbb2d;
        }
        
        .save-settings {
            background: #1a2a6c;
            color: white;
            padding: 15px;
            width: 100%;
            margin-top: 15px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-top: 20px;
            width: 100%;
        }

        .end-button {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-top: 20px;
            width: 100%;
        }
        .btn-large {
            padding: 16px;
            font-size: 18px;
        }
        
        .premium-feature {
            position: relative;
            overflow: hidden;
        }
        
        .premium-label {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #fdbb2d;
            color: #1a2a6c;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .pro-label {
            background: #fdbb2d;
            color: #1a2a6c;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .scouting-list {
            margin-top: 20px;
        }
        
        .scouting-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 5px solid #1a2a6c;
        }
        
        .scouting-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .scouting-date {
            color: #666;
            font-size: 14px;
        }
        
        .delete-btn {
            color: #d9534f;
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
        }
        
        .scouting-detail-item {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dotted #ddd;
            padding: 3px 0;
        }
        
        .highlight-stat {
            font-weight: bold;
            color: #1a2a6c;
        }
        
        /* Media query voor iets grotere schermen */
        @media (min-width: 480px) {
            .setup-form {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        /* Media query voor tablets */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            
            .container {
                max-width: 700px;
            }
            
            .action-buttons {
                grid-template-columns: 1fr 1fr;
            }
            
            .scouting-details {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        .stats-grid-2 {
          display: grid;
          grid-template-columns: repeat(2, minmax(0, 1fr));
          gap: 8px 16px;         /* rij- en kolomafstand */
          align-items: start;
        }

        /* Mobiel: 1 kolom */
        @media (max-width: 480px) {
          .stats-grid-2 { grid-template-columns: 1fr; }
        }

        /* Meer witruimte tussen kolommen in scouting-details */
        /* Basis: 2 kolommen, iets ruimere kolom-gap */
        .scouting-details {
          margin-top: 10px;
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 10px 28px;   /* rij-gap 10, kolom-gap 28 */
          font-size: 14px;
        }

        /* Tablet/desktop: 3 kolommen en nog wat meer ruimte */
        @media (min-width: 768px) {
          .scouting-details {
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 12px 36px;
          }
        }

       /* Zorg dat links en rechts op dezelfde Y staan */
        .site-header .app-version{
          position: absolute;
          right: 16px;
          top: 12px;           /* referentiehoogte rechts */
        }

        .header-left{
          position: absolute;
          left: 16px;
          top: 12px;           /* zelfde hoogte als app-version */
          transform: none;     /* weghalen van translateY(-50%) */
          display: flex;
          align-items: center;
        }

        .brand-logo{
          height: 28px;        /* pas aan naar smaak (24–32px) */
          width: auto;
          object-fit: contain;
        }

        /* Extra ruimte zodat niets overlapt met het middenblok */
        .site-header{
          position: relative;
          min-height: 88px;    /* eventueel 72–96px, wat je mooi vindt */
          padding: 12px 72px;  /* ruimte links/rechts voor logo & label */
        }

        /* === Responsive playtime label === */
        .playtime-section {
          flex-wrap: wrap;           /* mag afbreken op kleine schermen */
          gap: 8px 12px;             /* wat lucht tussen label en timer */
        }

        .playtime-display {
          /* Fluid font en breedte: groeit op grote schermen, krimpt op kleine */
          font-size: clamp(16px, 6vw, 24px);
          padding: 0.35em 0.75em;
          min-width: clamp(70px, 22vw, 110px);
          line-height: 1;
          border-radius: 14px;       /* iets subtieler op mobiel */
        }

        /* Extra kleine schermen (smalle gsm's) */
        @media (max-width: 380px) {
          .playtime-label { font-size: 14px; }
          .playtime-label i { font-size: 1rem; }
          .playtime-display {
            font-size: clamp(15px, 7vw, 20px);
            padding: 0.3em 0.6em;
            min-width: clamp(64px, 24vw, 96px);
          }
        }

        /* Logo links uitlijnen op kleine schermen */
        @media (max-width: 480px) {
          header { 
            text-align: left;            /* ook de subtitel links */
            padding-left: 12px;          /* wat lucht links */
            padding-right: 60px;         /* ruimte voor de "FREE VERSION" badge rechts */
          }
          .logo {
            justify-content: flex-start; /* icon + tekst links binnen de logo-div */
            margin-left: 0; 
            margin-right: auto;          /* forceer naar links */
          }
          .logo-icon { 
            margin-right: 6px;           /* iets compacter op gsm */
          }
        }

        /* tabs: op gsm alleen iconen tonen */
        @media (max-width: 480px) {
          .tabs .tab {
            font-size: 0;          /* verbergt de tekst */
            padding: 10px 0;       /* compacter */
          }
          .tabs .tab i {
            font-size: 18px;       /* icon blijft zichtbaar */
            line-height: 1;
            margin: 0;             /* geen extra ruimte rond icon */
          }
        }



    </style>
</head>
<body>
    <div class="container">
        <header class="site-header">
          <!-- vast links -->
          <div class="header-left">
            <img src="rectusoft.png" alt="Rectusoft" class="brand-logo">
          </div>
            <div class="logo">
                <!--<span class="logo-icon"><i class="fas fa-water"></i></span>-->
                <span>Canoepolo Scouting</span>
            </div>
            <p>Track results of canoepolo players</p>
            <div class="app-version">FREE VERSION</div>
        </header>
        
        <div id="setupScreen" class="setup-screen">
            <div class="setup-title"><i class="fas fa-cog"></i> Game Settings</div>
            <div class="setup-form">
                <div class="input-group">
                    <label for="setupPlayerName">Player Name</label>
                    <input type="text" id="setupPlayerName" placeholder="Speler naam">
                </div>
                <div class="input-group">
                    <label for="setupPlayerNumber">Player Jersey Number</label>
                    <input type="number" id="setupPlayerNumber" placeholder="Rugnummer">
                </div>
                <div class="input-group">
                    <label for="setupOwnTeam">Your Team</label>
                    <input type="text" id="setupOwnTeam" placeholder="Jouw team naam">
                </div>
                <div class="input-group">
                    <label for="setupOpponent">Opponent</label>
                    <input type="text" id="setupOpponent" placeholder="Tegenstander team">
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="setupIsGoalkeeper">
                    <label for="setupIsGoalkeeper">Is this player a goalkeeper?</label>
                </div>
            </div>
            <button class="btn btn-success btn-large" onclick="saveSetup()">Start Scouting</button>
        </div>
        
        <div id="mainContent" style="display: none;">
            <div class="player-header">
                <div class="player-info-compact" id="playerInfoCompact">
                    <!-- Hier komt de samengevatte spelerinfo -->
                </div>
                <button class="edit-player-btn" onclick="showSetupScreen()"><i class="fas fa-edit"></i> Modify player</button>
            </div>
            
            <div class="tabs">
                <div class="tab active" onclick="switchTab('scouting')"aria-label="Scouting"><i class="fas fa-binoculars"></i>Scouting</div>
                <div class="tab" onclick="switchTab('stats')" aria-label="Stats"><i class="fas fa-chart-bar"></i> Stats</div>
                <div class="tab" onclick="switchTab('scorepanel')"aria-label="Scorepanel"><i class="fas fa-minus-square"></i>Panel</div>
                <div class="tab" onclick="switchTab('settings')"aria-label="Settings"><i class="fas fa-cog"></i>Settings</div>
                
            </div>
            
            <div id="scouting" class="tab-content active">
                <!-- Speeltijd sectie -->
                <div class="playtime-section">
                    <div class="playtime-label">
                        <i class="fas fa-clock"></i>Effective playing time
                    </div>
                    <div class="playtime-display" id="playtimeDisplay">00:00</div>
                </div>
                
                <div class="playtime-controls">
                     <button class="time-control-btn btn-grijs" id="addMinuteBtn" onclick="addMinute()">+1 min</button>
                    <button class="playtime-btn not-playing" id="playtimeBtn" onclick="togglePlaytime()">Player in the substitution zone</button>
                    <button class="time-control-btn btn-grijs" id="subtractMinuteBtn" onclick="subtractMinute()">-1 min</button>
                </div>
                
                <div class="stats-container">
                    <!-- Passen rij -->
                    <div class="stat-row">
                        <div class="stat-box">
                            <div class="stat-button">
                                <button class="stat-btn btn-primary" id="goodPassBtn" onclick="increment('goodPasses')">
                                    <i class="fas fa-check-circle"></i>Good passes
                                    <div class="stat-value" id="goodPasses">0</div>
                                </button>
                                <button class="btn btn-grijs btn-small" id="goodPassMinusBtn" onclick="decrement('goodPasses')">-1</button>
                            </div>
                        </div>
                        
                        <div class="stat-box">
                            <div class="stat-button">
                                <button class="stat-btn btn-secondary" id="badPassBtn" onclick="increment('badPasses')">
                                    <i class="fas fa-times-circle"></i>Bad passes
                                    <div class="stat-value" id="badPasses">0</div>
                                </button>
                                <button class="btn btn-grijs btn-small" id="badPassMinusBtn" onclick="decrement('badPasses')">-1</button>
                            </div>
                        </div>
                    </div>
                
                    <!-- Onderscheppingen en Assists rij -->
                    <div class="stat-row">
                        <div class="stat-box">
                            <div class="stat-button">
                                <button class="stat-btn btn-primary" id="assistBtn" onclick="increment('assists')">
                                    <i class="fas fa-assistive-listening-systems"></i>Assists
                                    <div class="stat-value" id="assists">0</div>
                                </button>
                                <button class="btn btn-grijs btn-small" id="assistMinusBtn" onclick="decrement('assists')">-1</button>
                            </div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-button">
                                <button class="stat-btn btn-primary" id="interceptionBtn" onclick="increment('interceptions')">
                                    <i class="fas fa-exchange-alt"></i>Interceptions
                                    <div class="stat-value" id="interceptions">0</div>
                                </button>
                                <button class="btn btn-grijs btn-small" id="interceptionMinusBtn" onclick="decrement('interceptions')">-1</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Doelpunten rij -->
                    <div class="stat-row">
                        <div class="stat-box">
                            <div class="stat-button">
                                <button class="stat-btn btn-primary" id="goalBtn" onclick="increment('goals')">
                                    <i class="fas fa-bullseye"></i>Goal
                                    <div class="stat-value" id="goals">0</div>
                                </button>
                                <button class="btn btn-grijs btn-small" id="goalMinusBtn" onclick="decrement('goals')">-1</button>
                            </div>
                        </div>
                        
                        <div class="stat-box">
                            <div class="stat-button">
                                <button class="stat-btn btn-secondary" id="attemptBtn" onclick="increment('attempts')">
                                    <i class="fas fa-bullseye"></i>Goal attempt
                                    <div class="stat-value" id="attempts">0</div>
                                </button>
                                <button class="btn btn-grijs btn-small" id="attemptMinusBtn" onclick="decrement('attempts')">-1</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Keeper knoppen (alleen zichtbaar als keeper is geselecteerd) -->
                    <div id="goalkeeperSection"> 
                        <div id="goalkeeperButtons">   
                            <div class="stat-row">  
                                <div class="stat-box">
                                    <div class="stat-button">
                                        <button class="stat-btn btn-primary" id="goalsDefendedBtn" onclick="increment('goalsDefended')">
                                            <i class="fas fa-shield-alt"></i>Goals defended
                                            <div class="stat-value" id="goalsDefended">0</div>
                                        </button>
                                        <button class="btn btn-grijs btn-small" id="goalsDefendedMinusBtn" onclick="decrement('goalsDefended')">-1</button>
                                    </div>
                                </div>

                                <div class="stat-box">
                                    <div class="stat-button">
                                        <button class="stat-btn btn-secondary" id="goalsAgainstBtn" onclick="increment('goalsAgainst')">
                                            <i class="fas fa-times-circle"></i>Goals against
                                            <div class="stat-value" id="goalsAgainst">0</div>
                                        </button>
                                        <button class="btn btn-grijs btn-small" id="goalsAgainstMinusBtn" onclick="decrement('goalsAgainst')">-1</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>              
                </div>
                <div class="end-button">
                    <button class="btn btn-success btn-large" id="endGameBtn" onclick="endGame()"><i class="fas fa-flag-checkered"></i> End of match</button>
                </div>
            </div>
            
            <div id="settings" class="tab-content">
                <h2><i class="fas fa-cog"></i>App Settings</h2>
                <div class="settings-grid">

                     <!-- Dit stuk wordt niet getoond -->
                    <div hidden> 
                        <div class="settings-group">
                            <div class="settings-title">Player Settings</div>
                            
                            <div class="input-group">
                                <label for="playerName">Player Name</label>
                                <input type="text" id="playerName" placeholder="Speler naam">
                            </div>
                            
                            <div class="input-group">
                                <label for="playerNumber">Player jersey number</label>
                                <input type="number" id="playerNumber" placeholder="Rugnummer">
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="isGoalkeeper" onchange="toggleGoalkeeperButtons()">
                                <label for="isGoalkeeper">Is this player a goalkeeper?</label>
                            </div>
                        </div>
                    </div>

                    <!-- Dit stuk wordt niet getoond -->
                    <div hidden>
                        <div class="settings-group">
                            <div class="settings-title">Team Settings</div>
                            
                            <div class="input-group">
                                <label for="ownTeam">Your team name</label>
                                <input type="text" id="ownTeam" placeholder="Jouw team naam">
                            </div>
                            
                            <div class="input-group">
                                <label for="opponent">Opponent</label>
                                <input type="text" id="opponent" placeholder="Tegenstander team">
                            </div>
                        </div>
                    </div>

                    <div class="settings-group">
                        <div class="settings-title">Game Settings</div>
                        
                        <div class="input-group">
                            <label for="halfDuration">Duration of a half (minutes)</label>
                            <input type="number" id="halfDuration" value="10">
                        </div>
                        
                        <div class="input-group">
                            <label for="numberOfHalves">Aantal speelhelften (1-6)</label>
                            <select id="numberOfHalves">
                                <option>1</option>
                                <option selected>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                                <option>6</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <button class="btn save-settings" onclick="saveSettings()"><i class="fas fa-save"></i>Save settings</button>
            </div>

            <div id="scorepanel" class="tab-content">
                <h2><i class="fas fa-person-digging"></i> Under construction</h2> 
            </div>
            
            <div id="stats" class="tab-content">
                <h2><i class="fas fa-chart-bar"></i>Statistics overview</h2>
                
                <div class="settings-group">
                  <div class="settings-title">Current player performance</div>
                  <!-- NIEUW: wrapper voor 2 kolommen -->
                  <div class="stats-grid-2">
                    <p>Effective playing time: <span id="totalPlaytime">00:00</span></p>
                    <p>Player involvement: <span id="involvement">0.0</span><span> /min</span></p>
                    <p>Goaleffectiveness: <span id="shotAccuracy">0%</span></p>
                    <p>Passing accuracy: <span id="passAccuracy">0%</span></p>
                    <p id="savePctText" style="display:none;">Save (goalkeeper): <span id="keeperSavePct">0%</span></p>
                    <p>Total passes: <span id="totalPasses">0</span></p>
                    <p>Total shots: <span id="totalShots">0</span></p>
                    <p>Assists: <span id="assist">0</span></p>
                    <p>Interceptions: <span id="totalInterceptions">0</span></p>
                    <p id="goalsAgainstText" style="display:none;">Goals against: <span id="goalsAgainstStat">0</span></p>
                    <p id="goalsDefendedText" style="display:none;">Goals defended: <span id="goalsDefendedStat">0</span></p>
                  </div>
                </div>
                
                <div class="scouting-list">
                    <div class="settings-title">Saved scouting reports</div>
                    <div id="savedScoutings">
                        <p>No scouting reports saved yet</p>
                    </div>
                </div>
                
                <div class="settings-group premium-feature">
                    <div class="premium-label">PRO VERSION</div>
                    <div class="settings-title">Advanced Statistics</div>
                    <p>More detailed statistics and trends available in the Pro version.</p>
                    <ul>
                        <li>Player involvement in the game</li>
                        <li>Trend analysis across multiple matches</li>
                        <li>Comparison with teammates</li>
                        <li>Export to Excel and PDF</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

   <script>
  // Simpele teller functionaliteit - Volgorde aangepast zodat onderscheppingen eerst komt
  const counters = {
    interceptions: 0,  // Nu bovenaan
    assists: 0,
    goals: 0,
    attempts: 0,
    goodPasses: 0,
    badPasses: 0,
    goalsAgainst: 0,
    goalsDefended: 0
  };

  const history = [];
  let playtime = 0; // in seconden
  let playtimeInterval = null;
  let isPlaying = false;
  let savedScoutings = [];
  let isGoalkeeper = false;

  // Update de samengevatte spelerinfo
  function updatePlayerInfoCompact() {
    const playerName = document.getElementById('playerName').value;
    const playerNumber = document.getElementById('playerNumber').value;
    const ownTeam = document.getElementById('ownTeam').value;
    const opponent = document.getElementById('opponent').value;

    let infoText = "";
    if (playerName) {
      infoText += `${playerName}`;
      if (playerNumber) {
        infoText += ` (#${playerNumber})`;
      }
    }

    if (ownTeam) {
      if (infoText) infoText += " | ";
      infoText += `${ownTeam}`;
    }

    if (opponent) {
      if (infoText) infoText += " vs ";
      infoText += `${opponent}`;
    }

    document.getElementById('playerInfoCompact').textContent = infoText || "No player information";
  }

  // Schakel knoppen in/uit op basis van speelstatus (behalve einde wedstrijd knop)
  function toggleButtons(enabled) {
    const buttons = [
      'interceptionBtn', 'interceptionMinusBtn',
      'assistBtn', 'assistMinusBtn',
      'goalBtn', 'goalMinusBtn',
      'attemptBtn', 'attemptMinusBtn',
      'goodPassBtn', 'goodPassMinusBtn',
      'badPassBtn', 'badPassMinusBtn',
      'addMinuteBtn', 'subtractMinuteBtn',
      'goalsAgainstBtn', 'goalsAgainstMinusBtn',
      'goalsDefendedBtn', 'goalsDefendedMinusBtn'
    ];

    buttons.forEach(btnId => {
      const btn = document.getElementById(btnId);
      if (btn) {
        btn.disabled = !enabled;
      }
    });
  }

  // Toon/verberg keeper knoppen
  function toggleGoalkeeperButtons() {
    isGoalkeeper = document.getElementById('isGoalkeeper').checked;
    const keeperSection = document.getElementById('goalkeeperSection');
    const keeperButtons  = document.getElementById('goalkeeperButtons');
    const goalsAgainstText  = document.getElementById('goalsAgainstText');
    const goalsDefendedText = document.getElementById('goalsDefendedText');

    if (isGoalkeeper) {
      keeperSection.style.display = 'block';
      keeperButtons.style.display = 'grid';
      goalsAgainstText.style.display = 'block';
      goalsDefendedText.style.display = 'block';
    } else {
      keeperSection.style.display = 'none';
      keeperButtons.style.display = 'none';
      goalsAgainstText.style.display = 'none';
      goalsDefendedText.style.display = 'none';
      counters.goalsAgainst = 0;
      counters.goalsDefended = 0;
      updateDisplay('goalsAgainst');
      updateDisplay('goalsDefended');
    }
  }

  // Toon setup scherm voor bewerken
  function showSetupScreen() {
    document.getElementById('setupScreen').style.display = 'block';
    document.getElementById('mainContent').style.display = 'none';

    // Vul de velden in met bestaande waarden
    document.getElementById('setupPlayerName').value   = document.getElementById('playerName').value;
    document.getElementById('setupPlayerNumber').value = document.getElementById('playerNumber').value;
    document.getElementById('setupOwnTeam').value      = document.getElementById('ownTeam').value;
    document.getElementById('setupOpponent').value     = document.getElementById('opponent').value;
    document.getElementById('setupIsGoalkeeper').checked = document.getElementById('isGoalkeeper').checked;
  }

  // Setup functies
  function saveSetup() {
    const playerName   = document.getElementById('setupPlayerName').value;
    const playerNumber = document.getElementById('setupPlayerNumber').value;
    const ownTeam      = document.getElementById('setupOwnTeam').value;
    const opponent     = document.getElementById('setupOpponent').value;
    const isGoalkeeper = document.getElementById('setupIsGoalkeeper').checked;

    if (!playerName || !playerNumber || !ownTeam || !opponent) {
      alert("Fill in all fields to start scouting!");
      return;
    }

    // Opslaan in instellingen
    document.getElementById('playerName').value   = playerName;
    document.getElementById('playerNumber').value = playerNumber;
    document.getElementById('ownTeam').value      = ownTeam;
    document.getElementById('opponent').value     = opponent;
    document.getElementById('isGoalkeeper').checked = isGoalkeeper;

    // Opslaan in localStorage
    localStorage.setItem('playerName', playerName);
    localStorage.setItem('playerNumber', playerNumber);
    localStorage.setItem('ownTeam', ownTeam);
    localStorage.setItem('opponent', opponent);
    localStorage.setItem('isGoalkeeper', isGoalkeeper);

    // Update samengevatte info
    updatePlayerInfoCompact();

    // Update keeper status
    toggleGoalkeeperButtons();

    // Verberg setup en toon hoofdcontent
    document.getElementById('setupScreen').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
  }

  function endGame() {
    const playerName   = document.getElementById('playerName').value;
    const playerNumber = document.getElementById('playerNumber').value;
    const ownTeam      = document.getElementById('ownTeam').value;
    const opponent     = document.getElementById('opponent').value;

    if (!playerName) {
      alert("Please enter the player's name!");
      return;
    }

    // --- Statistieken ---
    const totalPasses = (counters.goodPasses || 0) + (counters.badPasses || 0);
    const passAccuracy = totalPasses > 0
      ? Math.round((counters.goodPasses / totalPasses) * 100)
      : 0;

    // Veldschoten
    const totalShots = getTotalShots(counters);
    const shotAccuracy = totalShots > 0
      ? Math.round((counters.goals / totalShots) * 100)
      : 0;

    // Keeper Save%
    const savePct = calcSavePct(counters);

    const minutesPlayed = playtime / 60;

    const involvement = minutesPlayed > 0
      ? involvementPerMinute(counters, minutesPlayed, { passesIncludeAssists: true })
      : 0.0;

    // --- Scouting object ---
    const scouting = {
      id: Date.now(),
      date: new Date().toLocaleString('nl-NL'),
      playerName,
      playerNumber,
      ownTeam,
      opponent,
      playtime,
      isGoalkeeper,
      stats: { ...counters },
      totals: {
        totalPasses,
        passAccuracy,
        shotAccuracy,
        involvement,
        savePct
      }
    };

    // Opslaan
    savedScoutings.push(scouting);
    localStorage.setItem('savedScoutings', JSON.stringify(savedScoutings));

    // Update UI
    updateScoutingsList();

    alert(`Game of ${playerName} is saved!`);

    // Reset voor volgende speler
    resetAll();
  }

  /**
   * Betrokkenheid per minuut zonder dubbeltellingen.
   * - Assists tel je als aparte events.
   * - Goals en attempts zijn disjunct; totaal schoten = goals + attempts.
   * - Passes exclusief assists (als assists al in goodPasses zaten).
   *
   * @param {object} counters
   * @param {number} minutesPlayed  // in MINUTEN
   * @param {object} [opts]
   * @param {boolean} [opts.passesIncludeAssists=true]  // zet op false als jouw good/badPasses assists al uitsluiten
   * @returns {number} betrokkenheid per minuut (1 decimaal)
   */
  function involvementPerMinute(
    counters,
    minutesPlayed,
    { passesIncludeAssists = true } = {}
  ) {
    const m = +minutesPlayed || 0;
    if (m <= 0) return 0.0;

    const good = +counters.goodPasses || 0;
    const bad  = +counters.badPasses  || 0;
    const ast  = +counters.assists    || 0;
    const g    = +counters.goals      || 0;
    const att  = +counters.attempts   || 0;        // hier: pogingen ZONDER goal
    const ints = +counters.interceptions || 0;

    // Passes exclusief assists, om dubbeltelling te vermijden
    const passesTotal = good + bad;
    const passesExclAssists = passesIncludeAssists
      ? Math.max(0, passesTotal - ast)   // defensief: nooit negatief
      : passesTotal;

    // Volume = elke unieke actie precies één keer
    const rawInvolvement =
      passesExclAssists + ast + att + g + ints;

    const perMin = rawInvolvement / m;
    return Math.round(perMin * 10) / 10; // 1 decimaal
  }

  function updateScoutingsList() {
    const container = document.getElementById('savedScoutings');

    if (savedScoutings.length === 0) {
      container.innerHTML = '<p>No scouting reports saved yet.</p>';
      return;
    }

    container.innerHTML = '';

    // Sorteer van nieuwste naar oudste
    const sortedScoutings = [...savedScoutings].sort((a, b) => b.id - a.id);

    sortedScoutings.forEach(scouting => {
      const item = document.createElement('div');
      item.className = 'scouting-item';

      // Tijd
      const minutes = Math.floor((scouting.playtime ?? 0) / 60);
      const seconds = (scouting.playtime ?? 0) % 60;
      const playtimeStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

      // Fallback berekening voor involvement (per minuut) als het niet opgeslagen is
      const stats = scouting.stats || {};
      const raw =
        (stats.goodPasses ?? 0) +
        (stats.badPasses ?? 0) +
        (stats.goals ?? 0) +
        (stats.attempts ?? 0) +
        (stats.assists ?? 0) +
        (stats.interceptions ?? 0);

      const minutesPlayed = (scouting.playtime ?? 0) / 60;
      const fallbackInvolvement = minutesPlayed > 0 ? (raw / minutesPlayed).toFixed(1) : '0.0';

      const hasStoredInvolvement =
        scouting.totals && scouting.totals.involvement !== undefined && scouting.totals.involvement !== null;

      const involvementToShow = hasStoredInvolvement
        ? Number(scouting.totals.involvement).toFixed(1)
        : fallbackInvolvement;

      // Null-safe totals
      const totals = scouting.totals || {};
      const passAcc = totals.passAccuracy ?? 0;
      const shotAcc = totals.shotAccuracy ?? 0;
      const totalPasses = totals.totalPasses ?? ((stats.goodPasses ?? 0) + (stats.badPasses ?? 0));

      // Shots (aanval) en keeper-metrics
      const ga = stats.goalsAgainst ?? 0;
      const sv = stats.goalsDefended ?? 0;
      const totalShots = (stats.goals ?? 0) + (stats.attempts ?? 0);
      const shotsFaced = ga + sv;
      const savedSavePct = (scouting.totals && typeof scouting.totals.savePct === 'number')
        ? scouting.totals.savePct
        : (shotsFaced > 0 ? Math.round((sv / shotsFaced) * 100) : 0);

      item.innerHTML = `
        <div class="scouting-header">
          <strong>${scouting.playerName ?? 'Unknown'}${scouting.playerNumber ? ` (#${scouting.playerNumber})` : ''}, time played: ${playtimeStr}</strong>
          <span></span>
          <button class="delete-btn" onclick="deleteScouting(${scouting.id})"><i class="fas fa-trash"></i></button>
        </div>
        <div class="scouting-date">${scouting.date ?? ''} | Tegen: ${scouting.opponent ?? ''}</div>
        <div class="scouting-details">
          <div class="scouting-detail-item"><span>Player involvement:</span> <span class="highlight-stat">${involvementToShow}</span> <span style="opacity:.7">/min</span></div>
          <div class="scouting-detail-item"><span>Passing accuracy:</span> <span class="highlight-stat">${passAcc}%</span></div>
          <div class="scouting-detail-item"><span>Shot accuracy:</span> <span class="highlight-stat">${shotAcc}%</span></div>
          <div class="scouting-detail-item"><span>Total passes:</span> <span>${totalPasses}</span></div>
          <div class="scouting-detail-item"><span>Good passes:</span> <span>${stats.goodPasses ?? 0}</span></div>
          <div class="scouting-detail-item"><span>Bad passes:</span> <span>${stats.badPasses ?? 0}</span></div>
          <div class="scouting-detail-item"><span>Total shots opponent goal:</span> <span>${totalShots}</span></div>
          <div class="scouting-detail-item"><span>Goals:</span> <span>${stats.goals ?? 0}</span></div>
          <div class="scouting-detail-item"><span>Goal attempts:</span> <span>${stats.attempts ?? 0}</span></div>
          <div class="scouting-detail-item"><span>Interceptions:</span> <span>${stats.interceptions ?? 0}</span></div>
          <div class="scouting-detail-item"><span>Assists:</span> <span>${stats.assists ?? 0}</span></div>
          <div class="scouting-detail-item"><span></span></div>

          ${scouting.isGoalkeeper ? `
            <div><strong>Goalkeeper: </strong></div>
            <div class="scouting-detail-item"><span>Save%:</span> <span class="highlight-stat">${savedSavePct}%</span></div>
            <div class="scouting-detail-item"><span></span></div>
            <div class="scouting-detail-item"><span>Total shots faced:</span> <span>${shotsFaced}</span></div>
            <div class="scouting-detail-item"><span>Goals defended:</span> <span>${sv}</span></div>
            <div class="scouting-detail-item"><span>Goals against:</span> <span>${ga}</span></div>
          ` : ''}

        </div>
      `;

      container.appendChild(item);
    });
  }

  function deleteScouting(id) {
    if (confirm("Are you sure you want to delete this scouting?")) {
      savedScoutings = savedScoutings.filter(s => s.id !== id);
      localStorage.setItem('savedScoutings', JSON.stringify(savedScoutings));
      updateScoutingsList();
    }
  }

  // Laad instellingen van localStorage
  function loadSettings() {
    const playerName = localStorage.getItem('playerName');
    if (playerName) {
      document.getElementById('playerName').value = playerName;
      document.getElementById('setupPlayerName').value = playerName;
    }

    const playerNumber = localStorage.getItem('playerNumber');
    if (playerNumber) {
      document.getElementById('playerNumber').value = playerNumber;
      document.getElementById('setupPlayerNumber').value = playerNumber;
    }

    const ownTeam = localStorage.getItem('ownTeam');
    if (ownTeam) {
      document.getElementById('ownTeam').value = ownTeam;
      document.getElementById('setupOwnTeam').value = ownTeam;
    }

    const opponent = localStorage.getItem('opponent');
    if (opponent) {
      document.getElementById('opponent').value = opponent;
      document.getElementById('setupOpponent').value = opponent;
    }

    const halfDuration = localStorage.getItem('halfDuration');
    if (halfDuration) {
      document.getElementById('halfDuration').value = halfDuration;
    }

    const numberOfHalves = localStorage.getItem('numberOfHalves');
    if (numberOfHalves) {
      document.getElementById('numberOfHalves').value = numberOfHalves;
    }

    const isGoalkeeperSetting = localStorage.getItem('isGoalkeeper');
    if (isGoalkeeperSetting) {
      document.getElementById('isGoalkeeper').checked = isGoalkeeperSetting === 'true';
      document.getElementById('setupIsGoalkeeper').checked = isGoalkeeperSetting === 'true';
      isGoalkeeper = isGoalkeeperSetting === 'true';
      toggleGoalkeeperButtons();
    }

    const scoutings = localStorage.getItem('savedScoutings');
    if (scoutings) {
      savedScoutings = JSON.parse(scoutings);
      updateScoutingsList();
    }

    updatePlayerInfoCompact();
  }

  // Sla instellingen op in localStorage
  function saveSettings() {
    const playerName   = document.getElementById('playerName').value;
    const playerNumber = document.getElementById('playerNumber').value;
    const ownTeam      = document.getElementById('ownTeam').value;
    const opponent     = document.getElementById('opponent').value;
    const halfDuration = document.getElementById('halfDuration').value;
    const numberOfHalves = document.getElementById('numberOfHalves').value;
    const isGoalkeeper = document.getElementById('isGoalkeeper').checked;

    localStorage.setItem('playerName', playerName);
    localStorage.setItem('playerNumber', playerNumber);
    localStorage.setItem('ownTeam', ownTeam);
    localStorage.setItem('opponent', opponent);
    localStorage.setItem('halfDuration', halfDuration);
    localStorage.setItem('numberOfHalves', numberOfHalves);
    localStorage.setItem('isGoalkeeper', isGoalkeeper);

    updatePlayerInfoCompact();
    toggleGoalkeeperButtons();

    alert('Settings saved!');
  }

  // Speeltijd functies
  function togglePlaytime() {
    isPlaying = !isPlaying;
    const playtimeBtn = document.getElementById('playtimeBtn');

    if (isPlaying) {
      playtimeBtn.textContent = "Player is on the field";
      playtimeBtn.classList.remove('not-playing');
      playtimeBtn.classList.add('playing');

      // Schakel knoppen in
      toggleButtons(true);

      // Start de timer
      playtimeInterval = setInterval(() => {
        playtime++;
        updatePlaytimeDisplay();
      }, 1000);
    } else {
      playtimeBtn.textContent = "Player is in the substitution zone";
      playtimeBtn.classList.remove('playing');
      playtimeBtn.classList.add('not-playing');

      // Schakel knoppen uit
      toggleButtons(false);

      // Stop de timer
      clearInterval(playtimeInterval);
    }
  }

  function addMinute() {
    playtime += 60;
    updatePlaytimeDisplay();
  }

  function subtractMinute() {
    if (playtime >= 60) {
      playtime -= 60;
      updatePlaytimeDisplay();
    }
  }

  function updatePlaytimeDisplay() {
    const minutes = Math.floor(playtime / 60);
    const seconds = playtime % 60;
    document.getElementById('playtimeDisplay').textContent =
      `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

    // Update ook in statistieken
    document.getElementById('totalPlaytime').textContent =
      `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

    updateStats();
  }

  function increment(counterName) {
    counters[counterName]++;
    updateDisplay(counterName);
    history.push({type: 'increment', counter: counterName});
    updateStats();
  }

  function decrement(counterName) {
    if (counters[counterName] > 0) {
      counters[counterName]--;
      updateDisplay(counterName);
      history.push({type: 'decrement', counter: counterName});
      updateStats();
    }
  }

  function updateDisplay(counterName) {
    document.getElementById(counterName).textContent = counters[counterName];
  }

  function updateStats() {
    // total passes & accuracies
    const totalPasses = (counters.goodPasses || 0) + (counters.badPasses || 0);
    const passAccuracy = totalPasses > 0
      ? Math.round((counters.goodPasses / totalPasses) * 100)
      : 0;

    // SHOT ACCURACY veldspeler: goals / (goals + attempts)
    const totalShots = getTotalShots(counters);
    const shotAccuracy = totalShots > 0
      ? Math.round((counters.goals / totalShots) * 100)
      : 0;

    // Keeper Save%
    const savePct = calcSavePct(counters); // 0..100

    // tijd (minuten)
    const minutesPlayed = playtime / 60;

    // BETROKKENHEID — zonder dubbeltellingen
    const involvementValue = involvementPerMinute(counters, minutesPlayed, {
      // Zet op false als jouw good/badPasses assists al uitsluiten.
      passesIncludeAssists: true
    });

    // schrijf naar DOM (alleen als elementen bestaan)
    const $ = id => document.getElementById(id);

    $('totalPasses')  && ($('totalPasses').textContent  = totalPasses);
    $('passAccuracy') && ($('passAccuracy').textContent = passAccuracy + '%');
    $('shotAccuracy') && ($('shotAccuracy').textContent = shotAccuracy + '%');
    $('involvement')  && ($('involvement').textContent  = involvementValue.toFixed(1));

    $('totalShots') && ($('totalShots').textContent = totalShots);
    $('totalInterceptions') && ($('totalInterceptions').textContent = counters.interceptions || 0);
    $('assist')             && ($('assist').textContent             = counters.assists || 0);
    $('goalsAgainstStat')  && ($('goalsAgainstStat').textContent  = counters.goalsAgainst || 0);
    $('goalsDefendedStat') && ($('goalsDefendedStat').textContent = counters.goalsDefended || 0);


    // Live Save% tonen (optioneel)
    if ($('keeperSavePct')) {
      $('keeperSavePct').textContent = savePct + '%';
    }
    if ($('savePctText')) {
      $('savePctText').style.display = isGoalkeeper ? 'block' : 'none';
    }
  }

  function switchTab(tabName) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
      tab.classList.remove('active');
    });

    document.querySelectorAll('.tab').forEach(tab => {
      tab.classList.remove('active');
    });

    // Show selected tab
    document.getElementById(tabName).classList.add('active');

    // Activate tab button
    document.querySelectorAll('.tab').forEach(tab => {
      if (tab.getAttribute('onclick').includes(tabName)) {
        tab.classList.add('active');
      }
    });

    // Update stats when switching to stats tab
    if (tabName === 'stats') {
      updateStats();
      updateScoutingsList();
    }
  }

  function resetAll() {
    for (const key in counters) {
      counters[key] = 0;
      updateDisplay(key);
    }
    playtime = 0;
    updatePlaytimeDisplay();

    if (isPlaying) {
      togglePlaytime(); // Stop de timer als die loopt
    }

    history.length = 0;
    updateStats();
  }

  // Laad instellingen wanneer de pagina geladen is
  window.onload = function() {
    loadSettings();
    updatePlaytimeDisplay();
    updateStats();

    // Altijd eerst setup scherm tonen
    document.getElementById('setupScreen').style.display = 'block';
    document.getElementById('mainContent').style.display = 'none';

    // Schakel knoppen initieel uit
    toggleButtons(false);
  };

  // Helpers
  function getTotalShots(c) {
    return (Number(c.goals) || 0) + (Number(c.attempts) || 0);
  }

  // Keeper Save% helper (Save% = saves / (saves + GA) * 100)
  function calcSavePct(c) {
    const ga = (+c.goalsAgainst)  || 0;  // goals against
    const sv = (+c.goalsDefended) || 0;  // goals saved
    const shots = ga + sv;               // shots faced
    return shots > 0 ? Math.round((sv / shots) * 100) : 0;
  }
</script>

</body>
</html>